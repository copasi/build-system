#!/usr/bin/env bash

. ${BUILD_ROOT}/variables/linux

if [ _"${TGT_ARCH}" != _x64} ]; then
  export TGT_ARCH=x64

  export CC=`which gcc`
  export CXX=`which g++`
  export MKLROOT=${HOME_BUILD_SYSTEM}/env-build/
  # export LD_LIBRARY_PATH=$($CC -print-search-dirs |
  #   sed '/^lib/b 1;d;:1;s,/[^/.][^/]*/\.\./,/,;t 1;s,:[^=]*=,:;,;s,;,;  ,g' |
  #   awk -- '{print $2}')
  export PATH=$PATH:${QTDIR}/bin:${BUILD_SYSTEM}/bin:${QTDIR}/libexec

  export BUILD_TOOL=`which ninja`

  COMMON_CMAKE_OPTIONS="-G Ninja;-DCMAKE_BUILD_TYPE=${BUILD_TYPE:-Release}"
  COMMON_CMAKE_OPTIONS="${COMMON_CMAKE_OPTIONS};-DSELECT_QT=${SELECT_QT}"
  export COMMON_CMAKE_OPTIONS
  
  COPASI_CMAKE_OPTIONS="-DENABLE_JIT=ON"
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DBLA_VENDOR=\"Intel (MKL)\""
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DCOPASI_USE_QCUSTOMPLOT=ON"
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DENABLE_JAVA=ON"
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DENABLE_CSHARP=ON"
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DWITH_DATAVISUALIZATION_NAMESPACES=OFF"
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DCOPASI_DEPENDENCY_DIR=$(convertPath ${INSTALL_DIR})"
  COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DCMAKE_INSTALL_PREFIX=${BUILD_SYSTEM}/packages/setup.release/usr"
  
  
  export COPASI_CMAKE_OPTIONS

  DEPENDENCIES_CMAKE_OPTIONS="-DCMAKE_INSTALL_PREFIX=$(convertPath ${INSTALL_DIR})"
  DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_zlib=OFF"
  DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_clapack=OFF"
  DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_NativeJIT=ON"
  DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_qwtplot3d=OFF"
  DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_uuid=ON"
  export DEPENDENCIES_CMAKE_OPTIONS
fi

