#!/usr/bin/env bash

export MKLROOT=$HOME_BUILD_SYSTEM/env-build/Library/
export Qt6_DIR=${Qt6_DIR:-${HOME_BUILD_SYSTEM}/6.8.0/msvc2022_64/lib/cmake/Qt6}
export SELECT_QT=Qt6
export VARIABLES=$HOME_BUILD_SYSTEM/build-system/variables/windows-msys
export DIR_SUFFIX=release
export BUILD_ROOT=$HOME_BUILD_SYSTEM/build-system
export BUILD_SYSTEM=${BUILD_ROOT}
export INSTALL_DIR=${BUILD_ROOT}/local
export BUILD_DIR=${BUILD_ROOT}/build
export LOG_DIR=${BUILD_ROOT}/log
export BUILD_TOOL=ninja
export COPASI_SCP=

export COPASI_SOURCES="${BUILD_ROOT}/git/COPASI.${DIR_SUFFIX}"

export COPASI_SOURCES="${COPASI_SOURCES:-${BUILD_ROOT}/git/COPASI.${DIR_SUFFIX}}"
export COPASI_SETUP_DIR="${BUILD_ROOT}/packages/setup.${DIR_SUFFIX}"

[ -e "${INSTALL_DIR}" ] || mkdir -p "${INSTALL_DIR}"
[ -e "${BUILD_DIR}" ] || mkdir -p "${BUILD_DIR}"
[ -e "${LOG_DIR}" ] || mkdir -p "${LOG_DIR}"
[ -e "${COPASI_SETUP_DIR}" ] || mkdir -p "${COPASI_SETUP_DIR}"

COMMON_CMAKE_OPTIONS="-G;Ninja"
COMMON_CMAKE_OPTIONS="${COMMON_CMAKE_OPTIONS};-DCMAKE_BUILD_TYPE=${BUILD_TYPE:-Release}"
COMMON_CMAKE_OPTIONS="${COMMON_CMAKE_OPTIONS};-DWITH_STATIC_RUNTIME=ON"
COMMON_CMAKE_OPTIONS="${COMMON_CMAKE_OPTIONS};-DSELECT_QT=${SELECT_QT:-Qt6}"
COMMON_CMAKE_OPTIONS="${COMMON_CMAKE_OPTIONS};-DQt6_DIR=${Qt6_DIR}"
export COMMON_CMAKE_OPTIONS

COPASI_CMAKE_OPTIONS="-DBUILD_SE=ON"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DCOPASI_USE_QCUSTOMPLOT=ON"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DENABLE_JAVA=ON"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DENABLE_CSHARP=ON"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DENABLE_JIT=ON"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DDISABLE_STACK_PROTECTOR=ON"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DMKLROOT=${MKLROOT}"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DF2C_INTEGER=int"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DWITH_DATAVISUALIZATION_NAMESPACES=OFF"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DCOPASI_DEPENDENCY_DIR=${INSTALL_DIR:-install}"
COPASI_CMAKE_OPTIONS="${COPASI_CMAKE_OPTIONS};-DCMAKE_INSTALL_PREFIX=${COPASI_SETUP_DIR}"
export COPASI_CMAKE_OPTIONS

DEPENDENCIES_CMAKE_OPTIONS="-DCMAKE_INSTALL_PREFIX=${INSTALL_DIR:-install}"
DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_clapack=OFF"
DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_NativeJIT=ON"
DEPENDENCIES_CMAKE_OPTIONS="${DEPENDENCIES_CMAKE_OPTIONS};-DBUILD_qwtplot3d=OFF"
export DEPENDENCIES_CMAKE_OPTIONS